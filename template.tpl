___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "displayName": "Soreto",
  "description": "Soreto GTM Template to facilitate the implementation of the Soreto JavaScript tag.",
  "type": "TAG",
  "categories": [
    "AFFILIATE_MARKETING",
    "ADVERTISING",
    "SOCIAL"
  ],
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "brand": {
    "id": "github.com_soreto",
    "displayName": "Soreto",
    "thumbnail": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABFCAYAAAC1+eO9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ1IDc5LjE2MzQ5OSwgMjAxOC8wOC8xMy0xNjo0MDoyMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUYyQjRCNkJFRERCMTFFOUIyNjhBNTgzRTQ3NUU0RUIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUYyQjRCNkNFRERCMTFFOUIyNjhBNTgzRTQ3NUU0RUIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RjJCNEI2OUVEREIxMUU5QjI2OEE1ODNFNDc1RTRFQiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RjJCNEI2QUVEREIxMUU5QjI2OEE1ODNFNDc1RTRFQiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgjsLZ8AAAdxSURBVHja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"
  },
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "clientId",
    "displayName": "Client Id",
    "simpleValueType": true
  },
  {
    "type": "TEXT",
    "name": "firstName",
    "displayName": "First Name",
    "simpleValueType": true,
    "canBeEmptyString": true
  },
  {
    "type": "TEXT",
    "name": "email",
    "displayName": "Email",
    "simpleValueType": true,
    "canBeEmptyString": true
  },
  {
    "type": "TEXT",
    "name": "orderId",
    "displayName": "Order Id",
    "simpleValueType": true
  },
  {
    "type": "TEXT",
    "name": "orderTotal",
    "displayName": "Order Total",
    "simpleValueType": true
  },
  {
    "type": "TEXT",
    "name": "country",
    "displayName": "Country",
    "simpleValueType": true,
    "canBeEmptyString": true
  }
]


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "SORETO"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://api.soreto.com/scripts/soreto.min.js"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// Enter your template code here.
const log = require('logToConsole');
const setInWindow = require('setInWindow');
const injectScript = require('injectScript');

log('data =', data);

/*** Do not change ***/
var SORETO = {};
SORETO.Client = {};
SORETO.User = {};
SORETO.Order = {};
/*** Set your transaction parameters ***/
SORETO.Client.id = data.clientId;
SORETO.User.firstName = data.firstName;
SORETO.User.email = data.email;
SORETO.Order.id = data.orderId;
SORETO.Order.total = data.orderTotal;
if(data.country)
  SORETO.Order.country = data.country;

log(SORETO);

setInWindow('SORETO', SORETO, true);

const url = 'https://api.soreto.com/scripts/soreto.min.js';
injectScript(url, data.gtmOnSuccess, data.gtmOnFailure, url);

// Call data.gtmOnSuccess when the tag is finished.
data.gtmOnSuccess();


___NOTES___

Created on 21/10/2019, 16:27:36
